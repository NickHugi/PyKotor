# IFO (Module Info)

Part of the [GFF File Format Documentation](GFF-File-Format).


IFO files define module-level metadata including entry configuration, expansion requirements, area lists, and module-wide script hooks. IFO files are the "main" descriptor for game modules, specifying where the player spawns and what scripts run at module scope.

**Reference**: [`Libraries/PyKotor/src/pykotor/resource/generics/ifo.py`](https://github.com/th3w1zard1/PyKotor/blob/master/Libraries/PyKotor/src/pykotor/resource/generics/ifo.py)

## Core Module Identity

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_ID` | Void (16 bytes) | Unique module identifier (GUID) |
| `Mod_Tag` | CExoString | Module tag identifier |
| `Mod_Name` | CExoLocString | Module name (localized) |
| `Mod_Creator_ID` | DWord | Toolset creator ID |
| `Mod_Version` | DWord | Module version number |
| `Mod_VO_ID` | CExoString | Voice-over folder name |

**Module Identification:**

- **Mod_ID**: 16-byte GUID generated by toolset
- **Mod_Tag**: Script-accessible identifier
- **Mod_Name**: Displayed in load screens
- **Mod_VO_ID**: Subfolder in StreamVoice for voice files

## Entry Configuration

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_Entry_Area` | ResRef | Starting area ResRef |
| `Mod_Entry_X` | Float | Entry X coordinate |
| `Mod_Entry_Y` | Float | Entry Y coordinate |
| `Mod_Entry_Z` | Float | Entry Z coordinate |
| `Mod_Entry_Dir_X` | Float | Entry direction X (facing) |
| `Mod_Entry_Dir_Y` | Float | Entry direction Y (facing) |

**Player Spawn:**

- **Mod_Entry_Area**: Initial area to load (ARE/GIT)
- **Entry Position**: XYZ coordinates in world space
- **Entry Direction**: Player's initial facing angle
  - Direction computed as: `atan2(Dir_Y, Dir_X)`

**Module Start Sequence:**

1. Load IFO to get entry configuration
2. Load Mod_Entry_Area (ARE + GIT)
3. Spawn player character at Entry position
4. Set player orientation from Entry direction
5. Execute Mod_OnModStart script

## Area List

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_Area_list` | List | Areas in this module |

**Mod_Area_list Struct Fields:**

- `Area_Name` (ResRef): Area ResRef (ARE file)

**Area Management:**

- Lists all areas accessible in module
- Areas loaded on-demand as player transitions
- KotOR modules typically have 1 area per module
- KotOR2 can have multiple areas per module

## Expansion Pack Requirements

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Expansion_Pack` | Word | Required expansion bitfield |
| `Mod_MinGameVer` | CExoString | Minimum game version |

**Expansion Flags (Bitfield):**

- **0x01**: Requires expansion pack 1
- **0x02**: Requires expansion pack 2
- Additional bits for future expansions

**Version Requirements:**

- **Mod_MinGameVer**: Minimum executable version
- Prevents loading in older game versions
- Format: "1.0", "1.03", "2.0", etc.

## Starting Movie & HAK Files

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_StartMovie` | ResRef | Starting movie file |
| `Mod_Hak` | CExoString | Required HAK file list |

**Module Initialization:**

- **Mod_StartMovie**: BIK movie played before module loads
- **Mod_Hak**: Semicolon-separated HAK file names
- HAKs loaded before module resources

**HAK System:**

- HAK files override base game resources
- Custom content (models, textures, scripts)
- Listed in load priority order

## Cache & XP Settings

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_IsSaveGame` | Byte | Module is from save file |
| `Mod_CacheNSSData` | Byte | Cache compiled scripts |
| `Mod_XPScale` | Byte | Experience point multiplier (0-200%) |

**Module Flags:**

- **Mod_IsSaveGame**: Internal flag (always 0 in files)
- **Mod_CacheNSSData**: Performance optimization
- **Mod_XPScale**: 100 = normal, 200 = double XP

## DawnStar Property (Unused)

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_DawnHour` | Byte | Dawn start hour (unused) |
| `Mod_DuskHour` | Byte | Dusk start hour (unused) |
| `Mod_MinPerHour` | DWord | Minutes per hour (unused) |

**Day/Night Cycle:**

- Defined but unused in KotOR
- Intended for time-based events
- No dynamic lighting/NPC schedules

## Module Script Hooks

| Field | Type | Description |
| ----- | ---- | ----------- |
| `Mod_OnAcquirItem` | ResRef | Fires when item acquired |
| `Mod_OnActvtItem` | ResRef | Fires when item activated/used |
| `Mod_OnClientEntr` | ResRef | Fires on player enter (multiplayer) |
| `Mod_OnClientLeav` | ResRef | Fires on player leave (multiplayer) |
| `Mod_OnCutsnAbort` | ResRef | Fires when cutscene aborted |
| `Mod_OnHeartbeat` | ResRef | Fires periodically (~6 seconds) |
| `Mod_OnModLoad` | ResRef | Fires when module finishes loading |
| `Mod_OnModStart` | ResRef | Fires after player spawned |
| `Mod_OnPlrDeath` | ResRef | Fires when player dies |
| `Mod_OnPlrDying` | ResRef | Fires when player HP reaches 0 |
| `Mod_OnPlrEqItm` | ResRef | Fires when equipment changed |
| `Mod_OnPlrLvlUp` | ResRef | Fires on level up |
| `Mod_OnPlrRest` | ResRef | Fires when player rests |
| `Mod_OnPlrUnEqItm` | ResRef | Fires when equipment removed |
| `Mod_OnSpawnBtnDn` | ResRef | Fires on spawn button (multiplayer) |
| `Mod_OnUnAqreItem` | ResRef | Fires when item lost/sold |
| `Mod_OnUsrDefined` | ResRef | Fires on user-defined events |

**Script Execution:**

- Module scripts run in module context
- Can access/modify module-wide state
- Higher scope than area scripts

**Common Script Uses:**

**Mod_OnModLoad:**

- Initialize global variables
- Setup persistent data structures
- Load saved state

**Mod_OnModStart:**

- Start cinematics
- Give starting equipment
- Setup initial conversations

**Mod_OnHeartbeat:**

- Update timers
- Check global conditions
- Ambient system updates

**Mod_OnPlrDeath:**

- Game over sequence
- Respawn handling
- Load last save

## Implementation Notes

**Module Loading Sequence:**

1. **Read IFO**: Parse module metadata
2. **Check Requirements**: Verify Expansion_Pack and MinGameVer
3. **Load HAKs**: Mount HAK files in order
4. **Play Movie**: Show Mod_StartMovie if set
5. **Load Entry Area**: Read ARE + GIT for Mod_Entry_Area
6. **Spawn Player**: Place at Entry position/direction
7. **Fire OnModLoad**: Execute module load script
8. **Fire OnModStart**: Execute module start script
9. **Start Gameplay**: Enable player control

**IFO vs. ARE vs. GIT:**

- **IFO**: Module-level metadata and entry config
- **ARE**: Static area properties (lighting, fog, grass)
- **GIT**: Dynamic object instances (creatures, doors, etc.)

**Save Game Integration:**

- IFO saved with current state
- Entry position updated to save location
- Module scripts preserved
- Mod_IsSaveGame flag set

**Module Transitions:**

- When transitioning to new module:
  1. Current module IFO updated with player position
  2. Current module saved to save game
  3. New module IFO loaded
  4. Player spawned at new Entry position (or LinkedTo waypoint)

**Multi-Area Modules (KotOR2):**

- Mod_Area_list contains multiple areas
- Areas loaded as needed
- Transitions within module don't fire OnModStart
- Shared module-level state

**Single-Area Modules (KotOR1):**

- Typical KotOR1 pattern
- One area per IFO
- Module transition = area transition
- Simpler resource management

**Script Scope Hierarchy:**

1. **Module Scripts** (IFO): Highest scope, module-wide
2. **Area Scripts** (ARE): Area-specific events
3. **Object Scripts** (UTC/UTD/etc.): Individual object events

**Common Module Configurations:**

**Story Modules:**

- Specific entry position for narrative flow
- StartMovie for cinematics
- OnModStart for dialogue/cutscenes
- Custom HAKs for unique content

**Hub Modules:**

- Central entry position (hub center)
- Multiple area transitions
- Vendors, NPCs, quest givers
- No start movie typically

**Combat Modules:**

- Entry position near enemies
- OnModStart spawns for ambush
- Battle music configured
- XPScale adjusted for difficulty

**Tutorial Modules:**

- Guided entry position
- OnModStart tutorial dialogue
- Reduced XPScale
- Special script hooks for teaching mechanics

