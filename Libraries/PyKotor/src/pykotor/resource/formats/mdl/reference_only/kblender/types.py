from __future__ import annotations

from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from typing_extensions import Literal

from pykotor.resource.formats.mdl.reference_only.constants import Classification

# BEGIN Function Pointers

MODEL_FN_PTR_1_K1_PC: Literal[4273776] = 4273776
MODEL_FN_PTR_1_K2_PC: Literal[4285200] = 4285200
MODEL_FN_PTR_2_K1_PC: Literal[4216096] = 4216096
MODEL_FN_PTR_2_K2_PC: Literal[4216320] = 4216320
MODEL_FN_PTR_1_K1_XBOX: Literal[4254992] = 4254992
MODEL_FN_PTR_2_K1_XBOX: Literal[4255008] = 4255008
MODEL_FN_PTR_1_K2_XBOX: Literal[4285872] = 4285872
MODEL_FN_PTR_2_K2_XBOX: Literal[4216016] = 4216016

ANIM_FN_PTR_1_K1_PC: Literal[4273392] = 4273392
ANIM_FN_PTR_2_K1_PC: Literal[4451552] = 4451552
ANIM_FN_PTR_1_K2_PC: Literal[4284816] = 4284816
ANIM_FN_PTR_2_K2_PC: Literal[4522928] = 4522928
ANIM_FN_PTR_1_K1_XBOX: Literal[4253536] = 4253536
ANIM_FN_PTR_2_K1_XBOX: Literal[4573360] = 4573360
ANIM_FN_PTR_1_K2_XBOX: Literal[4285488] = 4285488
ANIM_FN_PTR_2_K2_XBOX: Literal[4523088] = 4523088

MESH_FN_PTR_1_K1_PC: Literal[4216656] = 4216656
MESH_FN_PTR_2_K1_PC: Literal[4216672] = 4216672
MESH_FN_PTR_1_K2_PC: Literal[4216880] = 4216880
MESH_FN_PTR_2_K2_PC: Literal[4216896] = 4216896
MESH_FN_PTR_1_K1_XBOX: Literal[4267376] = 4267376
MESH_FN_PTR_2_K1_XBOX: Literal[4264048] = 4264048
MESH_FN_PTR_1_K2_XBOX: Literal[4216576] = 4216576
MESH_FN_PTR_2_K2_XBOX: Literal[4216592] = 4216592

SKIN_FN_PTR_1_K1_PC: Literal[4216592] = 4216592
SKIN_FN_PTR_1_K2_PC: Literal[4216816] = 4216816
SKIN_FN_PTR_2_K1_PC: Literal[4216608] = 4216608
SKIN_FN_PTR_2_K2_PC: Literal[4216832] = 4216832
SKIN_FN_PTR_1_K1_XBOX: Literal[4264032] = 4264032
SKIN_FN_PTR_2_K1_XBOX: Literal[4264048] = 4264048
SKIN_FN_PTR_1_K2_XBOX: Literal[4216512] = 4216512
SKIN_FN_PTR_2_K2_XBOX: Literal[4216528] = 4216528

DANGLY_FN_PTR_1_K1_PC: Literal[4216640] = 4216640
DANGLY_FN_PTR_1_K2_PC: Literal[4216864] = 4216864
DANGLY_FN_PTR_2_K1_PC: Literal[4216624] = 4216624
DANGLY_FN_PTR_2_K2_PC: Literal[4216848] = 4216848
DANGLY_FN_PTR_1_K1_XBOX: Literal[4266736] = 4266736
DANGLY_FN_PTR_2_K1_XBOX: Literal[4266720] = 4266720
DANGLY_FN_PTR_1_K2_XBOX: Literal[4216560] = 4216560
DANGLY_FN_PTR_2_K2_XBOX: Literal[4216544] = 4216544

# END Function Pointers

MODEL_MODEL: Literal[2] = 2
MODEL_ANIM: Literal[5] = 5

CLASS_OTHER: Literal[0x00] = 0x00
CLASS_EFFECT: Literal[0x01] = 0x01
CLASS_TILE: Literal[0x02] = 0x02
CLASS_CHARACTER: Literal[0x04] = 0x04
CLASS_DOOR: Literal[0x08] = 0x08
CLASS_LIGHTSABER: Literal[0x10] = 0x10
CLASS_PLACEABLE: Literal[0x20] = 0x20
CLASS_FLYER: Literal[0x40] = 0x40

CLASS_BY_VALUE: dict[int, Classification] = {
    CLASS_OTHER: Classification.OTHER,
    CLASS_EFFECT: Classification.EFFECT,
    CLASS_TILE: Classification.TILE,
    CLASS_CHARACTER: Classification.CHARACTER,
    CLASS_DOOR: Classification.DOOR,
    CLASS_LIGHTSABER: Classification.LIGHTSABER,
    CLASS_PLACEABLE: Classification.PLACEABLE,
    CLASS_FLYER: Classification.FLYER,
}

NODE_BASE: Literal[0x0001] = 0x0001
NODE_LIGHT: Literal[0x0002] = 0x0002
NODE_EMITTER: Literal[0x0004] = 0x0004
NODE_REFERENCE: Literal[0x0010] = 0x0010
NODE_MESH: Literal[0x0020] = 0x0020
NODE_SKIN: Literal[0x0040] = 0x0040
NODE_DANGLY: Literal[0x0100] = 0x0100
NODE_AABB: Literal[0x0200] = 0x0200
NODE_SABER: Literal[0x0800] = 0x0800

MDX_FLAG_VERTEX: Literal[0x0001] = 0x0001
MDX_FLAG_UV1: Literal[0x0002] = 0x0002
MDX_FLAG_UV2: Literal[0x0004] = 0x0004
MDX_FLAG_UV3: Literal[0x0008] = 0x0008
MDX_FLAG_UV4: Literal[0x0010] = 0x0010
MDX_FLAG_NORMAL: Literal[0x0020] = 0x0020
MDX_FLAG_COLOR: Literal[0x0040] = 0x0040
MDX_FLAG_TANGENT1: Literal[0x0080] = 0x0080
MDX_FLAG_TANGENT2: Literal[0x0100] = 0x0100
MDX_FLAG_TANGENT3: Literal[0x0200] = 0x0200
MDX_FLAG_TANGENT4: Literal[0x0400] = 0x0400

EMITTER_FLAG_P2P: Literal[0x0001] = 0x0001
EMITTER_FLAG_P2P_SEL: Literal[0x0002] = 0x0002
EMITTER_FLAG_AFFECTED_WIND: Literal[0x0004] = 0x0004
EMITTER_FLAG_TINTED: Literal[0x0008] = 0x0008
EMITTER_FLAG_BOUNCE: Literal[0x0010] = 0x0010
EMITTER_FLAG_RANDOM: Literal[0x0020] = 0x0020
EMITTER_FLAG_INHERIT: Literal[0x0040] = 0x0040
EMITTER_FLAG_INHERIT_VEL: Literal[0x0080] = 0x0080
EMITTER_FLAG_INHERIT_LOCAL: Literal[0x0100] = 0x0100
EMITTER_FLAG_SPLAT: Literal[0x0200] = 0x0200
EMITTER_FLAG_INHERIT_PART: Literal[0x0400] = 0x0400
EMITTER_FLAG_DEPTH_TEXTURE: Literal[0x0800] = 0x0800
EMITTER_FLAG_13: Literal[0x1000] = 0x1000

AABB_NO_CHILDREN: Literal[0x00] = 0x00
AABB_POSITIVE_X: Literal[0x01] = 0x01
AABB_POSITIVE_Y: Literal[0x02] = 0x02
AABB_POSITIVE_Z: Literal[0x04] = 0x04
AABB_NEGATIVE_X: Literal[0x08] = 0x08
AABB_NEGATIVE_Y: Literal[0x10] = 0x10
AABB_NEGATIVE_Z: Literal[0x20] = 0x20

NUM_SABER_VERTS: Literal[176] = 176
CTRL_FLAG_BEZIER: Literal[0x10] = 0x10

CTRL_BASE_POSITION: Literal[8] = 8
CTRL_BASE_ORIENTATION: Literal[20] = 20
CTRL_MESH_SCALE: Literal[36] = 36
CTRL_MESH_SELFILLUMCOLOR: Literal[100] = 100
CTRL_MESH_ALPHA: Literal[132] = 132
CTRL_LIGHT_COLOR: Literal[76] = 76
CTRL_LIGHT_RADIUS: Literal[88] = 88
CTRL_LIGHT_SHADOWRADIUS: Literal[96] = 96
CTRL_LIGHT_VERTICALDISPLACEMENT: Literal[100] = 100
CTRL_LIGHT_MULTIPLIER: Literal[140] = 140
CTRL_EMITTER_ALPHAEND: Literal[80] = 80
CTRL_EMITTER_ALPHASTART: Literal[84] = 84
CTRL_EMITTER_BIRTHRATE: Literal[88] = 88
CTRL_EMITTER_BOUNCE_CO = 92
CTRL_EMITTER_COMBINETIME: Literal[96] = 96
CTRL_EMITTER_DRAG: Literal[100] = 100
CTRL_EMITTER_FPS: Literal[104] = 104
CTRL_EMITTER_FRAMEEND: Literal[108] = 108
CTRL_EMITTER_FRAMESTART: Literal[112] = 112
CTRL_EMITTER_GRAV: Literal[116] = 116
CTRL_EMITTER_LIFEEXP: Literal[120] = 120
CTRL_EMITTER_MASS: Literal[124] = 124
CTRL_EMITTER_P2P_BEZIER2: Literal[128] = 128
CTRL_EMITTER_P2P_BEZIER3: Literal[132] = 132
CTRL_EMITTER_PARTICLEROT: Literal[136] = 136
CTRL_EMITTER_RANDVEL: Literal[140] = 140
CTRL_EMITTER_SIZESTART: Literal[144] = 144
CTRL_EMITTER_SIZEEND: Literal[148] = 148
CTRL_EMITTER_SIZESTART_Y: Literal[152] = 152
CTRL_EMITTER_SIZEEND_Y: Literal[156] = 156
CTRL_EMITTER_SPREAD: Literal[160] = 160
CTRL_EMITTER_THRESHOLD: Literal[164] = 164
CTRL_EMITTER_VELOCITY: Literal[168] = 168
CTRL_EMITTER_XSIZE: Literal[172] = 172
CTRL_EMITTER_YSIZE: Literal[176] = 176
CTRL_EMITTER_BLURLENGTH: Literal[180] = 180
CTRL_EMITTER_LIGHTNINGDELAY: Literal[184] = 184
CTRL_EMITTER_LIGHTNINGRADIUS: Literal[188] = 188
CTRL_EMITTER_LIGHTNINGSCALE: Literal[192] = 192
CTRL_EMITTER_LIGHTNINGSUBDIV: Literal[196] = 196
CTRL_EMITTER_LIGHTNINGZIGZAG: Literal[200] = 200
CTRL_EMITTER_ALPHAMID: Literal[216] = 216
CTRL_EMITTER_PERCENTSTART: Literal[220] = 220
CTRL_EMITTER_PERCENTMID: Literal[224] = 224
CTRL_EMITTER_PERCENTEND: Literal[228] = 228
CTRL_EMITTER_SIZEMID: Literal[232] = 232
CTRL_EMITTER_SIZEMID_Y: Literal[236] = 236
CTRL_EMITTER_RANDOMBIRTHRATE: Literal[240] = 240
CTRL_EMITTER_TARGETSIZE: Literal[252] = 252
CTRL_EMITTER_NUMCONTROLPTS: Literal[256] = 256
CTRL_EMITTER_CONTROLPTRADIUS: Literal[260] = 260
CTRL_EMITTER_CONTROLPTDELAY: Literal[264] = 264
CTRL_EMITTER_TANGENTSPREAD: Literal[268] = 268
CTRL_EMITTER_TANGENTLENGTH: Literal[272] = 272
CTRL_EMITTER_COLORMID: Literal[284] = 284
CTRL_EMITTER_COLOREND: Literal[380] = 380
CTRL_EMITTER_COLORSTART: Literal[392] = 392


EMITTER_CONTROLLER_KEYS: list[tuple[int, str, int]] = [
    (CTRL_EMITTER_ALPHAEND, "alphaend", 1),
    (CTRL_EMITTER_ALPHASTART, "alphastart", 1),
    (CTRL_EMITTER_BIRTHRATE, "birthrate", 1),
    (CTRL_EMITTER_BOUNCE_CO, "bounce_co", 1),
    (CTRL_EMITTER_COMBINETIME, "combinetime", 1),
    (CTRL_EMITTER_DRAG, "drag", 1),
    (CTRL_EMITTER_FPS, "fps", 1),
    (CTRL_EMITTER_FRAMEEND, "frameend", 1),
    (CTRL_EMITTER_FRAMESTART, "framestart", 1),
    (CTRL_EMITTER_GRAV, "grav", 1),
    (CTRL_EMITTER_LIFEEXP, "lifeexp", 1),
    (CTRL_EMITTER_MASS, "mass", 1),
    (CTRL_EMITTER_P2P_BEZIER2, "p2p_bezier2", 1),
    (CTRL_EMITTER_P2P_BEZIER3, "p2p_bezier3", 1),
    (CTRL_EMITTER_PARTICLEROT, "particlerot", 1),
    (CTRL_EMITTER_RANDVEL, "randvel", 1),
    (CTRL_EMITTER_SIZESTART, "sizestart", 1),
    (CTRL_EMITTER_SIZEEND, "sizeend", 1),
    (CTRL_EMITTER_SIZESTART_Y, "sizestart_y", 1),
    (CTRL_EMITTER_SIZEEND_Y, "sizeend_y", 1),
    (CTRL_EMITTER_SPREAD, "spread", 1),
    (CTRL_EMITTER_THRESHOLD, "threshold", 1),
    (CTRL_EMITTER_VELOCITY, "velocity", 1),
    (CTRL_EMITTER_XSIZE, "xsize", 1),
    (CTRL_EMITTER_YSIZE, "ysize", 1),
    (CTRL_EMITTER_BLURLENGTH, "blurlength", 1),
    (CTRL_EMITTER_LIGHTNINGDELAY, "lightningdelay", 1),
    (CTRL_EMITTER_LIGHTNINGRADIUS, "lightningradius", 1),
    (CTRL_EMITTER_LIGHTNINGSCALE, "lightningscale", 1),
    (CTRL_EMITTER_LIGHTNINGSUBDIV, "lightningsubdiv", 1),
    (CTRL_EMITTER_LIGHTNINGZIGZAG, "lightningzigzag", 1),
    (CTRL_EMITTER_ALPHAMID, "alphamid", 1),
    (CTRL_EMITTER_PERCENTSTART, "percentstart", 1),
    (CTRL_EMITTER_PERCENTMID, "percentmid", 1),
    (CTRL_EMITTER_PERCENTEND, "percentend", 1),
    (CTRL_EMITTER_SIZEMID, "sizemid", 1),
    (CTRL_EMITTER_SIZEMID_Y, "sizemid_y", 1),
    (CTRL_EMITTER_RANDOMBIRTHRATE, "randombirthrate", 1),
    (CTRL_EMITTER_TARGETSIZE, "targetsize", 1),
    (CTRL_EMITTER_NUMCONTROLPTS, "numcontrolpts", 1),
    (CTRL_EMITTER_CONTROLPTRADIUS, "controlptradius", 1),
    (CTRL_EMITTER_CONTROLPTDELAY, "controlptdelay", 1),
    (CTRL_EMITTER_TANGENTSPREAD, "tangentspread", 1),
    (CTRL_EMITTER_TANGENTLENGTH, "tangentlength", 1),
    (CTRL_EMITTER_COLORMID, "colormid", 3),
    (CTRL_EMITTER_COLOREND, "colorend", 3),
    (CTRL_EMITTER_COLORSTART, "colorstart", 3),
]


class ControllerKey:
    def __init__(
        self,
        ctrl_type: int,
        num_rows: int,
        timekeys_start: int,
        values_start: int,
        num_columns: int,
    ):
        self.ctrl_type: int = ctrl_type
        self.num_rows: int = num_rows
        self.timekeys_start: int = timekeys_start
        self.values_start: int = values_start
        self.num_columns: int = num_columns
