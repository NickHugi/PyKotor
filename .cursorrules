# PyKotor Rules and Conventions for AI LLM agents

## Documentation

When creating ANY new `.md` files, always follow these guidelines:

- Never report on progression (changes and what still remains to be done).
- Exclusively provide public-facing documentation, something an end user will need to read if they want to either develop for PyKotor or work with it.
- All documentation must go into the root-level `./docs` folder.

Please do not create .md documentation unless relevant to a public-facing end user for PyKotor.

## Helper Scripts

- Always place within `scripts`
- Should be idempotent and flexible enough to be used for a plethora of scenarios, not just whatever the task you're working on involves.
- Do not delete helper .py/.ps1/.sh scripts when you are finished with them; keep them in scripts folder

## Terminal usage

- Always check the operating system you're functioning in. Do NOT try to execute e.g. bash commands on powershell or vice versa. Most of the time you'lle xclusively be writing powershell given the windows-dominant nature of this repo's intended recipients.

### Python usage in terminal

- Use `uv` when possible
- Setup venvs with `./install_python_venv.ps1` following its parameters closely `param( [switch]$noprompt, [string]$venv_name = ".venv", [string]$force_python_version )`. NEVER use `python -m venv`
- If python isn't installed, ask the user if they want to install it (if yes, run install_python_venv with python 3.9 as the target). Ensure you explain to them what you will be doing if you require a yes or no answer.

## Conventions

- When developing code, please ensure you ALWAYS check the .gitmodules and the ./vendor folder to find semantically similar code. For any hits, please always comment in the python code what relpath/line number it can be found at and any differences if any. This should be as full and complete as possible.

## Reference Material

- Use ./vendor for code examples working with the KOTOR game. Note that some projects may be inaccurate or incomplete. Assume reone, xoreos, kotor.js, mdlops, and tga2tpc or anything by ndix UR are the most accurate, with everything else being significantly questionable.
- Use ./wiki if you require information about the codebase.
- Always assume ./docs has highly inaccurate and questionable material; try not to reference it unless absolutely necessary. Always second-guess its contents!

### Submodules in this PyKotor project

Relevance to pykotor means a few different things. All relevant submodules should:

- contain source code for something relevant to the game. i.e.. literal mods on public github repos are just mods and not really relevant to improving PyKotor's codebase as a whole.
- Actually has somewhat accurate content, and is somewhat comprehensive (at least 500 lines of code or so written).
- Is something we wouldn't regret being associated with. For example something that is involved in piracy or anything should NOT be included or referenced by PyKotor


### Codebase Structure

- Libraries contains shared code, structured `Libraries/<project_name>/src/pykotor/<short_pythonic_module_name>/__init__.py`. `pykotor` should exclusively be the only namespace module (meaning does NOT contain a `__init__.py`).
- Tools contains public-facing projects and apps, structured `Tools/<project_name>/src/<short_pythonic_module_name>/__init__.py`. Everything in here must have implementations in ./compile and .github/workflows for their releases. A config.py will define all of the versioning information, see existing examples for e.g. holopatcher and holocron toolset.
- `./compile` contains powershell scripts designed to pyinstaller a specific Tool to executable binary. Everything and anything in `./Tools` should be provided in `./compile`.
- `./dist` is the intended output directory for compiled binaries
- `./tests` contains any and all tests for the PyKotor repository.
- `./Engines` a WIP engine for the game using Panda3d, based heavily on reone/kotor.js/xoreos.
- `./scripts`: Helper scripts for various tasks. By design this will always be cluttered.
- `logs`: One or more of the tools will be outputting logs here (probably holopatcher/toolset), should always be in `.gitignore`.
- .env: contains PYTHONPATH, K1_PATH, K2_PATH, etc used for tests and python environment configs. Should match the exact paths used in `.vscode/settings.json` and root-level `./pyproject.toml`'s paths.


## Linting

- Always use `ruff`. Don't use anything else!


See `./CONVENTIONS.md` for more information!